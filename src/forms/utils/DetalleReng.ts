export const config = {
  byKey: {
    Reglon49: {
      label:
        "Reglon 49 Según el parágrafo 1 del artículo 1.2.1.10.3 del DUT 1625 de 2016, modificado con el art.2 del Decreto 1457 de nov, de 2020, estos dividendos sí se podrán restar 100% como no gravados en el renglón 60 y sin importar el tipo de sociedad que los haya entregado",
    },
    RecibidosDeSociedadNacionalDelRegimenOrdinarioQueSiLlevaACaboLasMegainversionesDelArt235:
      {
        label:
          "Recibidos de sociedad nacional del Régimen Ordinario que sí lleva a cabo las Megainversiones del art.235-3 del ET",
      },
    RecibidosDeSociedadNacionalDelRegimenOrdinarioQueNoLlevaACaboLasMegainversionesDelArt235YQueNoEstaAcogidaAlRegimenDeSociedadesCHCDeLosArts894A898DelET:
      {
        label:
          "Recibidos de sociedad nacional del Régimen Ordinario que no lleva a cabo las Megainversiones del art.235-3 del ET. y que no está acogida al régimen de sociedades CHC de los arts. 894 a 898 del ET)",
      },
    RecibidosDeSociedadNacionalDelRegimenOrdinarioQueNoLlevaACaboLasMegainversionesDelArt235PeroQueSiEstaAcogidaAlRegimenDeSociedadesCHCDeLosArts894A898DelET:
      {
        label:
          'Recibidos de sociedad nacional del Régimen Ordinario que no lleva a cabo las Megainversiones del art.235-3 del ET. pero que sí está acogida al régimen de sociedades CHC de los arts. 894 a 898 del ET, reglamentados con el Decreto 598 de abril 6 de 2020). De acuerdo con el art. 25 literal "e" del ET, y el art. 895 del ET, si la persona no residente que se lleva estos dividendos no está ubicada en un territorio considerado "jurisdicción de nula tributación" (antiguos "paraísos fiscales"; ver listado e art. 1.2.2.5.1 del DUT 1625 de 2018), entonces no tiene ni siquiera que declarar este ingreso como ingreso bruto y luego restarlo como ingreso no gravado pues este ingreso no se considera ingreso de fuente nacional  (es decir, para efectos fiscales no se considera como obtenido en Colombia)',
      },
    RecibidosDeUnaSociedadNacionalDelRegimenSimple: {
      label:
        "Recibidos de una sociedad nacional del Régimen Simple (Ver art.. 911 del ET y art.1.2.1.10.7 del DUT 1625 de 2016 sustituido con el Dec.. 1457 de nov de 2020).",
    },
    TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosContablesADiciembre3152:
      {
        label:
          "Total Dividendos y/o participaciones gravadas, recibidos por personas naturales sin residencia fiscal (saldos contables a diciembre 31)",
      },
    TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosFiscalesADiciembre3152:
      {
        label:
          "Total Dividendos y/o participaciones gravadas, recibidos por personas naturales sin residencia fiscal (saldos fiscales a diciembre 31)",
      },
    Total53SaldosContablesADiciembre31: {
      label:
        "Total Dividendos y/o participaciones gravadas, recibidos por personas naturales sin residencia fiscal excepto las que se reportan en el renglón 56 (ver artículos 245 y 246 ET) (saldos contables a diciembre 31)",
    },
    Total53SaldosFiscalesADiciembre31: {
      label:
        "Total Dividendos y/o participaciones gravadas, recibidos por personas naturales sin residencia fiscal excepto las que se reportan en el renglón 56 (ver artículos 245 y 246 ET) (saldos fiscales a diciembre 31)",
    },
    RecSocNacSim54: {
      label:
        "Recibidos de una sociedad nacional del Régimen Simple (Ver art.. 911 del ET y art.1.2.1.10.7 del DUT 1625 de 2016 agregado con el Dec.. 2371 de dic.27 de 2019)",
    },
    Total54SaldosContablesADiciembre31: {
      label:
        "Total Dividendos y/o participaciones no gravadas, pero que tributarán al 10 %  (recibidos por sociedades extranjeras y personas naturales no residentes; ver artículo 245 del ET). Si recibieron dividendos no gravados años 2017 y siguientes pero entregados por sociedades que llevan a cabo megainversiones, los mismos no deben tributar y por eso la única solución sería reportarlos en el renglón 49 (ver artículo 235-3 del ET) (saldos contables a diciembre 31)",
    },
    Total54SaldosFiscalesADiciembre31: {
      label:
        "Total Dividendos y/o participaciones no gravadas, pero que tributarán al 10 %  (recibidos por sociedades extranjeras y personas naturales no residentes; ver artículo 245 del ET). Si recibieron dividendos no gravados años 2017 y siguientes pero entregados por sociedades que llevan a cabo megainversiones, los mismos no deben tributar y por eso la única solución sería reportarlos en el renglón 49 (ver artículo 235-3 del ET) (saldos fiscales a diciembre 31)",
    },
    Total56SaldosContablesADiciembre31: {
      label:
        "Total Dividendos y/o participaciones no gravadas, recibidos por establecimientos permanentes y por sociedades extranjeras , excepto las que se reportan en el renglón 56 (ver artículo 245 del ET) (saldos contables a diciembre 31)",
    },
    Total56SaldosFiscalesADiciembre31: {
      label:
        "Total Dividendos y/o participaciones no gravadas, recibidos por establecimientos permanentes y por sociedades extranjeras , excepto las que se reportan en el renglón 56 (ver artículo 245 del ET) (saldos fiscales a diciembre 31)",
    },
    DiviNoGrav: {
      label:
        "Dividendos no gravados de un ejercicio 2016 o anteriores, entregados por cualquier tipo de sociedad (ver los valores del renglón 46; ver parágrafo 1 del artículo 1.2.1.10.3 del DUT 1625 de 2016, modificado con el art.2 del Decreto 2371 de dic, de 2019, ",
    },
    AprtObl: {
      label:
        "Aportes obligatorios a EPS y Fondos de pensiones obligatorias en Colombia (arts. 55 y 56 del ET)",
    },
    AprtVol: {
      label:
        "Aportes voluntarios a fondos de pensiones obligatorias (art. 55 del ET (art. 55 del ET y arts. 1.2.1.12.9, el parágrafo 1 del 1.2.4.1.30 y el 1.2.4.1.41 del DUT 1625 de 2016 luego de ser modificados con los Dec.2250 dic de 2017, 1808 oct de 2019 y 2264 dic. 13 de 2019; no se pueden pasar el 25% del total de ingresos del renglón 53 y al mismo tiempo, en valores absolutos, no se pueden pasar de 2.500 UVT)",
    },
    UtilEnaj: {
      label:
        "Utilidad en la enajenación de acciones  inscritas en bolsa(art. 36-1 del ET)",
    },
    ValCap: {
      label:
        "Por valor capitalizado de la cuenta Revalorización del Patrimonio (ver art.36-3 del ET)",
    },
    Indem60: {
      label: "Indemnizaciones seguros daño emergente (art. 45 del ET)",
    },
    Recom60: {
      label: "Recompensas (art. 42 del ET)",
    },
    Ganan60: {
      label: "Gananciales (art 47 del ET)",
    },
    SubsAgro: {
      label: "Subsidios de Agroingreso seguro (art. 57-1 del ET)",
    },
    IndmnCompAseg: {
      label:
        "Indemnizaciones de compañías aseguradoras sobre  activos perdidos en situaciones de fuerza mayor (ver art. 148 del ET))",
    },
    RecCuen: {
      label:
        "Recuperación de cuentas por cobrar que se habían castigado (ver art, .195 del ET)",
    },
    RecDepre: {
      label:
        "Recuperación de la depreciación concedida sobre activos que luego se venden con utilidad (ver art. 190 y 196 del ET; ver este editorial: https://actualicese.com/utilidad-por-venta-de-activo-fijo-depreciable-que-sera-renta-por-recuperacion-de-deducciones/)",
    },
    Reglon72: {
      label:
        "Reglon 72: Renta líquida ordinaria del ejercicio sin casillas 52 a 56 (si 61+ 69 + 70 + 71 - 52 - 53 - 54 - 55 - 56 - 67 - 68 mayor a cero)",
    },
    Reglon73: {
      label:
        "Pérdida líquida del ejercicio sin casillas 52 a 56 ( si 52 + 53 + 54 + 55 + 56 + 67 + 68 - 61 - 69 - 70 - 71 mayor a cero) (*-39)",
    },
    CompenPerFisc: {
      label: "Compensaciones de pérdidas fiscales de años anteriores",
    },
    ExcRentPres: {
      label:
        "Por excesos de rentas presuntiva sobre renta líquida de cualquiera de los 5 años anteriores (2020, o 2019, o 2018, o 2017, o 2016). Los excesos que se obtuvieron hasta las declaraciones del 2016 sí se pueden reajustar fiscalmente pero los que se obtengan en las declaraciones del 2017 y siguientes no se pueden reajustar fiscalmente (ver art.189 del ET y el numeral 6 del art. 290 del ET)",
    },
    SubRentPres: {
      label:
        "Subtotal compensaciones que se podrían utilizar (el cual no puede exceder al valor del renglón 72)",
    },
    ValFinRentPres: {
      label:
        "Valor final de compensaciones por pérdidas fiscales y por exceso de renta presuntiva sobre liquida que se pueden utilizar",
    },
    Reglon75: {
      label: "Reglon 75: Renta líquida sin casillas 52 a 56 (72-74)",
    },
    Act235: {
      label:
        "Por las actividades del artículo 235-2 del ET (transporte fluvial)",
    },
    RentNet: {
      label:
        'Rentas netas (ingreso menos costos y gastos) obtenidas en Colombia pero que no deben producir impuesto en Colombia pues fueron obtenidas por personas naturales que están residiendo en países con los cuales se están aplicando actualmente algún "Convenio para evitar la doble tributación internacional" (Ejemplo: Ver Ley 1082 de 2006 con España, o Ley 1261 de 2008 con Chile, etc.)',
    },
    RentHot: {
      label:
        "Rentas hoteleras netas (ingresos menos costos y gastos) obtenidas en hoteles construidos o remodelados entre 2003 y 2017 (ver literal e de parágrafo 5 del artículo 240 del ET)",
    },
    RentExent: {
      label:
        "Renta exenta por regalías de derechos de autor (ver numeral 8 del artículo 235-2 del ET)",
    },
    PensColom: {
      label:
        "Pensiones obtenidas en Colombia (la parte que no exceda de 1.000 UVT mensuales; ver numeral 5 del art. 206 del ET)",
    },
    ActOmi: {
      label:
        "Activos omitidos en años anteriores no revisables por la Dian y que se están incluyendo  en el patrimonio fiscal de esta declaración de renta 2021; ver artículo 239-1 del ET; Recuérdese que los artículos 2 a 6 de la Ley 2155 de septiembre 14 de 2021 concedieron de nuevo la oportunidad de seguir ocultando estos activos al cierre del 2021 y normalizarlos solo durante febrero 28 de 2022 mediante. el formulario especial 445 en el cual se pagaría solo un impuesto del 17% sobre dichos activos; en todo caso el 50% de dicho impuesto se tuvo que haber pagado en calidad de anticipo durante noviembre de 2021; ver Decreto 1340 de octubre de 2021)",
    },
    PasivNoReal: {
      label:
        "Pasivos no reales incluidos en años anteriores no  revisables por la Dian y que se están eliminando  en el patrimonio fiscal de esta declaración de renta 2021; ver artículo 239-1 del ET; Recuérdese que los artículos 2 a 6 de la Ley 2155 de septiembre 14 de 2021 concedieron de nuevo la oportunidad de seguir incluyendo estos pasivos al cierre del 2021 y normalizarlos solo durante febrero de 2022 mediante. el formulario especial 445 en el cual se pagaría solo un impuesto del 17% sobre dichos pasivos; en todo caso el 50% de dicho impuesto se tuvo que haber pagado en calidad de anticipo durante noviembre de 2021; ver Decreto 1340 de octubre de 2021)",
    },
    RecEsp: {
      label:
        "Recuperación especial de deducciones (artículos 195 y 196 del ET)",
    },
    RentComp: {
      label:
        "Renta por comparación patrimonial (solo la calcula la DIAN; art. 236 del ET)",
    },
    RentLiq: {
      label:
        "Renta líquida por Pérdidas compensadas modificadas por Liquidación Oficial; art. 199 del ET)",
    },
    ValoresQuitasCap: {
      label:
        'Valores por "quitas de capital" (condonaciones de deudas) que le hayan hecho al contribuyente acogido a los procesos de reorganización empresarial de la Ley 1116 de 2006 o del Decreto-Ley 560 de abril de 2020',
    },
    VerLasInstruccionesAl: {
      label:
        'Ver las instrucciones que ya se dieron en el renglón 74 sobre las "compensaciones de pérdidas fiscales de años anteriores". Además, el valor que se registre en esta casilla no puede ser superior al valor del renglón 81 y adicionalmente se debe cumplir la regla de no tratarse de una pérdida que ya esté siendo restada dentro del renglón 74',
    },
    UtilVent: {
      label:
        "Utilidad en venta de acciones inscritas en bolsa y poseídas por más de dos años (art. 36-1 del ET)",
    },
    HerLegDon: {
      label:
        "Un parte de las herencias, legados y donaciones (ver art. 307 del ET) ",
    },
    IndemnSeguVid: {
      label:
        "Para las indemnizaciones por seguros de vida, solo se puede tomar como exento las primeras 12.500 UVT(unos $453.850.000 en el 2021)",
    },
    AprtSocLiq: {
      label:
        "De la parte recibida por encima del aporte social en los procesos de  liquidación de sociedades  donde era socio o accionista y siendo claro que la sociedad liquidada había existido por más de dos años(art. 301 del ET)",
    },
    Esc1: {
      label:
        "Escenario 1: cuando el valor en la casilla 81 (Rentas deudores régimen Ley 1116 de 2006, Decretos 560 y 772 de 2020) es igual a cero (0), el valor de las Ganancias ocasionales gravables será el resultado de la siguiente operación: casilla 80 Ingresos por ganancias ocasionales) menos casilla 83 (Costos por ganancias ocasionales) menos casilla 84 (Ganancias ocasionales no gravadas y exentas). En el caso de que el resultado de esta operación sea negativo, el valor de esta casilla será igual a cero (0)",
    },
    Esc2: {
      label:
        "Escenario 2: cuando el valor de la casilla 81 (Rentas deudores régimen Ley 1116 de 2006, Decretos 560 y 772 de 2020) sea mayor a cero (0) y el valor de la casilla 82 (Utilización pérdidas fiscales acumuladas (inc. 2, art. 15 Decreto 772 de 2020)) es igual a cero (0), el cálculo de las Ganancias ocasionales gravables será el resultado de la siguiente operación: Casilla 80 (Ingresos por ganancias ocasionales) más Casilla 81 (Rentas deudores régimen Ley 1116 de 2006, Decretos 560 y 772 de 2020) menos Casilla 83 (Costos por ganancias ocasionales) menos casilla 84 (Ganancias ocasionales no gravadas y exentas). Si el resultado es negativo, el valor de esta casilla será igual a cero (0)",
    },
    Esc3: {
      label:
        "Escenario 3: cuando el valor en la Casilla 81 (Rentas deudores régimen Ley 1116 de 2006, Decretos 560 y 772 de 2020) sea mayor a cero (0), el valor en la casilla 82 (Utilización pérdidas fiscales acumuladas (inc. 2, art. 15 Decreto 772 de 2020) sea mayor a cero (0), y la sumatoria de las casillas 83 (Costos por ganancias ocasionales) y 84 (Ganancias ocasionales no gravadas y exentas) no es mayor al valor de la casilla 80 (Ingresos por ganancias ocasionales), las Ganancias ocasionales gravables serán el resultado de la siguiente operación: Casilla 80 (Ingresos por ganancias ocasionales) más casilla 81 (Rentas deudores régimen Ley 1116 de 2006, Decretos 560 y 772 de 2020)) menos casilla 82 (Utilización pérdidas fiscales acumuladas (inc. 2, art. 15 Decreto 772 de 2020)) menos casilla 83 (Costos por ganancias ocasionales) menos casilla 84 (Ganancias ocasionales no gravadas y exentas). El valor máximo para diligenciar en la casilla 82 (Utilización pérdidas fiscales acumuladas (inc. 2, art. 15 Decreto 772 de 2020)) debe ser inferior o igual, al menor valor de las casillas 81 (Rentas deudores régimen Ley 1116 de 2006, Decretos 560 y 772 de 2020) o 32 (Pérdidas fiscales acumuladas años anteriores, sin compensar). ",
    },
    Esc4: {
      label:
        "Escenario 4: cuando el resultado de restar de la casilla 80 (Ingresos por ganancias ocasionales), el valor de la casilla 83 (Costos por ganancias ocasionales) sea negativo, es decir, que se genere una pérdida ocasional, y el valor de la casilla 82 (Utilización pérdidas fiscales acumuladas (inc. 2, art. 15 Decreto 772 de 2020) sea igual a cero (0), bien sea porque en la casilla 32 (Pérdidas fiscales acumuladas años anteriores, sin compensar) no existen pérdidas acumuladas, o de existir el declarante no las desea compensar con las rentas de la casilla 81 (Rentas deudores régimen Ley 1116 de 2006, Decretos 560 y 772 de 2020), el resultado de las Ganancias ocasionales gravables será el resultado de la siguiente operación: Casilla 80 (Ingresos por ganancias ocasionales) más casilla 81 (Rentas deudores régimen Ley 1116 de 2006, Decretos 560 y 772 de 2020) menos casilla 83 (Costos por ganancias ocasionales). Si el resultado es negativo, el valor de esta casilla será igual a cero (0).",
    },
    TotalImpuestoSobreLaRentaLiquidaSaldosFiscalesADiciembre31: {
      label:
        "Impuesto sobre la renta líquida gravable sin casillas 52 a 56 (base renglón 79; ver art. 247 del ET; 35%)",
    },
    Total88SaldosFiscalesADiciembre31: {
      label:
        "Total De dividendos y/o participaciones gravadas a la tarifa del artículo 240 del ET (base casilla 55):",
    },
    Total89SaldosFiscalesADiciembre31: {
      label:
        "Total De dividendos y/o participaciones gravadas a la tarifa del 27 % (base casilla 56)",
    },
    Total90SaldosFiscalesADiciembre31: {
      label:
        "Total De dividendos y/o participaciones gravadas a la tarifa  del art. 240 (31%+10% del 69%; ver art. 245 del ET) (base casilla 53)",
    },
    Total91SaldosFiscalesADiciembre31: {
      label:
        "Impuesto de dividendos y/o participaciones gravadas a la tarifa del 33% (base casilla 52).",
    },
    Total92SaldosFiscalesADiciembre31: {
      label:
        "Total impuesto sobre las rentas líquidas gravables (suma 86 a 91).",
    },
    DescuentosDonacionesEntidades: {
      label:
        "Descuento por Donaciones a entidades del régimen especial y a entidades no contribuyentes (Ver arts. 257 y 258 del ET; los artículos 1.2.1.4.1 hasta 1.2.1.4.7 del DUT 1625 de 2016 modificados con art. 1 del Decreto 2150 dic. 20 de 2017; Concepto Unificado 481 de abril de 2018",
    },
    PorIVACompra: {
      label:
        "  Por IVA en compra o construcción de bienes de capital que adquieran o construyan los contribuyentes de renta (sin importar si son o no generadores del IVA en sus ventas, es decir, sin importar sí son o no responsables del IVA; ver art. 258-1 del ET, reglamentado con el Decreto 1089 de agosto 3 de 2020 y afectado con la sentencia de la Corte Constitucional C-379 de septiembre 2 de 2020; ver este editorial https://actualicese.com/descuento-en-renta-por-iva-de-bienes-de-capital-fue-condicionado-por-la-corte-constitucional/",
    },
    RetTrasladable: {
      label:
        "   Por retención trasladable en dividendos que primero fueron recibidos por otra sociedad nacional (ver art. 242-1 del ET modificado con art. 50 Ley 2010 de 2019, y los artículos 1.2.4.7.9, 1.2.4.7.10 y 1.2.4.37 del DUT 1625 de 2016 sustituidos  con el art. 4 del Decreto 1457 de noviembre 27 de 2020; ver el siguiente editorial  de noviembre 18 de 2020 https://actualicese.com/tributacion-sobre-dividendos-y-su-respectiva-retencion-volvio-a-ser-reglamentada-parte-i/",
    },
    OtrosDescApliq: {
      label:
        "Otros  descuentos que apliquen a los contribuyentes del régimen ordinario pero sin incluir los que son exclusivos de los contribuyentes del régimen simple ( formato 1004 del año gravable 2021; art. 26 Resolución 0098 de octubre de 2020 modificada con la 147 de diciembre 7 de 2021): ver el producto virtual sobre información exógena año gravable 2021: https://actualicese.com/producto/guia-multiformato-novedades-en-la-preparacion-y-presentacion-de-informacion-exogena-tributaria-a-la-dian-por-el-ag-2021/",
    },
    Reglon96: {
      label:
        "Reglon 96: Descuentos por impuestos pagados en el exterior por ganancias ocasionales",
    },
    Reglon97: {
      label: "Reglon 97: Total impuesto a cargo (94+95-96)",
    },
    Reglon98: {
      label:
        "Reglon 98: Valor inversión obras por impuestos hasta del 50% del valor de la casilla 88 (Modalidad de pago 1)",
    },
    Reglon99: {
      label:
        "Reglon 99: Descuento efectivo inversión obras por impuestos (modalidad de pago 2)",
    },
    Reglon100: {
      label: "Reglon 100: Crédito fiscal artículo 256-1 ET",
    },
    Reglon105: {
      label: "Reglon 105: Total retenciones año gravable a declarar  (103+104)",
    },
    Reglon106: {
      label:
        " Reglon 106: Más: Anticipo renta para el año gravable siguiente (ver anexo)",
    },
    Reglon107: {
      label:
        " Reglon 107: Menos: Anticipo sobretasa instituciones financieras año gravable anterior",
    },
    Reglon108: {
      label: "Reglon 108: Más: Sobretasa instituciones financieras",
    },
    Reglon109: {
      label:
        "Reglon 109: Más: Anticipo sobretasa instituciones financieras año gravable siguiente",
    },
    Reglon110: {
      label:
        "Reglon 110: Saldo a pagar por impuesto  (si 97 + 106 + 108 + 109 - 98 - 99 - 100 - 101 - 102 -105 - 107 mayor a cero ; si el resultado es negativo escriba 0)",
    },
    Reglon112: {
      label:
        "Reglon 112: Total saldo a pagar (si 97 + 106 + 108 +109 + 111 - 98 - 99 - 100 - 101 - 102 - 105 - 107 mayor a cero; si el resultado es negativo escriba 0)",
    },
    Reglon113: {
      label:
        "Reglon 113: o Total saldo a favor  (si 98 + 99 +100 + 101+ 102 +105 + 107 - 97 - 106 - 108 - 109 - 111; si el resultado es negativo escriba 0) ",
    },
    Reglon114: {
      label:
        "Reglon 114: Valor total impuesto exigible por obras por impuestos modalidad de pago 1",
    },
    Reglon115: {
      label:
        "Reglon 115: Valor total proyecto obras por impuestos modalidad de pago 2",
    },
  },
};

export const calculateSaldosFiscalesParciales = (data: any) => {

    if(data?.SaldosFiscalesADiciembre31Parciales == null) {
      return;
    }

    data.SaldosFiscalesADiciembre31Parciales =
      (data?.SaldosContablesADiciembre31Parciales || 0) +
      (data?.AjustesParaLlegarASaldosFiscales1 || 0) -
      (data?.AjustesParaLlegarASaldosFiscales3 || 0);
  };

const regexTotalContables = /^Total\S*SaldosContablesADiciembre31/;
const regexTotalFiscales = /^Total\S*SaldosFiscalesADiciembre31/;

const totalSaldosExceptions = ["Renglon46", "Renglon93", "Renglon104"];

//Calcula el total de saldos contables y fiscales para un nivel específico
export const calculateTotalSaldos = (data: any, currentLevel: string) => {
  if (!data) {
    return;
  }

  if (totalSaldosExceptions.includes(currentLevel)) {
    return;
  }

  const currentData = data[currentLevel];


  if (!currentData) {
    return;
  }

  let totalFiscal = 0;
  let totalContable = 0;

  const labelFiscal = Object.keys(currentData).find((key) =>
    regexTotalFiscales.test(key)
  );
  const labelContable = Object.keys(currentData).find((key) =>
    regexTotalContables.test(key)
  );

  if (!labelFiscal || !labelContable) {
    return;
  }

  const processItem = (item: any) => {
    if (typeof item === "object" && item !== null) {
      if (typeof item.SaldosContablesADiciembre31Parciales === "number") {
        totalContable += item.SaldosContablesADiciembre31Parciales;
      }
      if (typeof item.SaldosFiscalesADiciembre31Parciales === "number") {
        totalFiscal += item.SaldosFiscalesADiciembre31Parciales;
      }

      // Recursivamente procesar propiedades del objeto
      Object.values(item).forEach((value) => {
        processItem(value);
      });
    }
  };

  Object.values(currentData).forEach((item) => {
    processItem(item);
  });

  data[currentLevel][labelContable] = totalContable;
  data[currentLevel][labelFiscal] = totalFiscal;
};

//Renglon 45 - 2404 Impuesto por Pagar de Renta y Complementarios
const calculateImpuestoPorPagarDeRentaYComplementarios = (data: any) => {
  if (!data) {
    return;
  }
  data.Renglon45[
    "2404ImpuestoPorPagarDeRentaYComplementarios"
  ].SaldosContablesADiciembre31Parciales =
    data?.Renglon112?.TotalSaldosFiscalesADiciembre31 || 0;
};

//Renglon 46 - Total Patrimonio Liquido Positivo
const calculateTotalPatrimonioLiquidoPositivo = (data: any) => {
  data.Renglon46.TotalPatrimonioLiquidoPositivoSaldosContablesADiciembre31 =
    (data?.Renglon44?.TotalSaldosContablesADiciembre31 || 0) -
    (data?.Renglon45?.TotalPasivosSaldosContablesADiciembre31 || 0);

  data.Renglon46.TotalPatrimonioLiquidoPositivoSaldosFiscalesADiciembre31 =
    (data?.Renglon44?.TotalSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon45?.TotalPasivosSaldosFiscalesADiciembre31 || 0);
};

//Renglon 46 - 3130 Capital de Personas Naturales
const calculateTotalPasivos = (data: any) => {
  if (data?.["3130CapitalDePersonasNaturales"] == null) {
    return;
  }

  data["3130CapitalDePersonasNaturales"].SaldosContablesADiciembre31Parciales =
    (data?.TotalPatrimonioLiquidoPositivoSaldosContablesADiciembre31 ||
    0) -
      ((data?.["3605ResultadoDelEjercicio"]?.UtilidadDespuesDeImpuestos
        ?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.["3605ResultadoDelEjercicio"]?.PerdidaDespuesDeImpuestos
          ?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.["3705UtilidadesDePeriodosAnteriores"]
          ?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.["3710PerdidasDeEjerciciosAnteriores"]
          ?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.[
          "3715GananciasPerdidasAcumuladasORetenidasPorLaAdopcionPorPrimera"
        ]?.GananciasAcumuladas?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.[
          "3715GananciasPerdidasAcumuladasORetenidasPorLaAdopcionPorPrimera"
        ]?.PerdidasAcumuladas?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.["3720OtroResultadoIntegralAcumulado"]?.GananciasAcumuladasORI
          ?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.["3720OtroResultadoIntegralAcumulado"]?.PerdidasAcumuladasORI
          ?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.["3805Superavit"]?.SaldosContablesADiciembre31Parciales || 0) +
        (data?.["3805Superavit"]?.PorMetodoDeParticipacion
          ?.SaldosContablesADiciembre31Parciales || 0));
};

//Renglon 44 - Total Patrimonio Bruto
const calculateTotalPatrimonioBruto = (data: any) => {
  data.Renglon44TotalPatrimonioBruto.TotalSaldosContablesADiciembre31 =
    (data?.Renglon36
      ?.TotalEfectivoYEquivalentesDeEfectivoSaldosContablesADiciembre31 || 0) +
    (data?.Renglon37
      ?.TotalInversionesEInstrumentosFinancierosDerivadosSaldosContablesADiciembre31 ||
      0) +
    (data?.Renglon38
      ?.TotalCuentasDocumentosYArrendamientosFinancierosPorCobrarSaldosContablesADiciembre31 ||
      0) +
    (data?.Renglon39?.TotalInventariosSaldosContablesADiciembre31 || 0) +
    (data?.Renglon40?.TotalActivosIntangiblesSaldosContablesADiciembre31 || 0) +
    (data?.Renglon41?.TotalActivosBiologicosSaldosContablesADiciembre31 || 0) +
    (data?.Renglon42
      ?.TotalPropiedadesPlantaEquipoPropiedadesDeInversionANCMVSaldosContablesADiciembre31 ||
      0) +
    (data?.Renglon43?.TotalOtrosActivosSaldosContablesADiciembre31 || 0);

  data.Renglon44TotalPatrimonioBruto.TotalSaldosFiscalesADiciembre31 =
    (data?.Renglon36
      ?.TotalEfectivoYEquivalentesDeEfectivoSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon37
      ?.TotalInversionesEInstrumentosFinancierosDerivadosSaldosFiscalesADiciembre31 ||
      0) +
    (data?.Renglon38
      ?.TotalCuentasDocumentosYArrendamientosFinancierosPorCobrarSaldosFiscalesADiciembre31 ||
      0) +
    (data?.Renglon39?.TotalInventariosSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon40?.TotalActivosIntangiblesSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon41?.TotalActivosBiologicosSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon42
      ?.TotalPropiedadesPlantaEquipoPropiedadesDeInversionANCMVSaldosFiscalesADiciembre31 ||
      0) +
    (data?.Renglon43?.TotalOtrosActivosSaldosFiscalesADiciembre31 || 0);
};

//Renglon 58 - Total Ingresos Brutos
const calculateTotalIngresosBrutos = (data: any) => {
  data.Renglon58.TotalIngresosBrutosSaldosContablesADiciembre31 =
    (data?.Renglon47
      ?.TotalIngresosBrutosDeActividadesOrdinariasSaldosContablesADiciembre31 ||
      0) +
    (data?.Renglon48?.TotalIngresosFinancierosSaldosContablesADiciembre31 ||
      0) +
    (data?.Renglon49
      ?.TotalDividentosOParticipacionesGananciaOcasionalSaldosContablesADiciembre31 ||
      0) +
    (data
      ?.Renglon50DividendosOParticipacionesDistribuidosPorEntidadesResidentesEnColombia
      ?.TotalSaldosContablesADiciembre31Parciales || 0) +
    (data
      ?.Renglon51DividendosOParticipacionesGravadasAñoRecibidosPorSociedadesExtranjeras
      ?.TotalSaldosContablesADiciembre31Parciales || 0) +
    (data?.Renglon52
      ?.TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosContablesADiciembre3152 ||
      0) +
    (data?.Renglon53?.Total53SaldosContablesADiciembre31 || 0) +
    (data?.Renglon54?.Total54SaldosContablesADiciembre31 || 0) +
    (data?.Renglon55?.TotalSaldosContablesADiciembre31Parciales || 0) +
    (data?.Renglon56?.Total56SaldosContablesADiciembre31 || 0) +
    (data?.Renglon57?.TotalOtrosIngresosSaldosContablesADiciembre31 || 0);

  data.Renglon58.TotalIngresosBrutosSaldosFiscalesADiciembre31 =
    (data?.Renglon47
      ?.TotalIngresosBrutosDeACtividadesOrdinariasSaldosFiscalesADiciembre31 ||
      0) +
    (data?.Renglon48?.TotalIngresosFinancierosSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon49
      ?.TotalDividentosOParticipacionesGananciaOcasionalSaldosFiscalesADiciembre31 ||
      0) +
    (data
      ?.Renglon50DividendosOParticipacionesDistribuidosPorEntidadesResidentesEnColombia
      ?.TotalSaldosFiscalesADiciembre31Parciales || 0) +
    (data
      ?.Renglon51DividendosOParticipacionesGravadasAñoRecibidosPorSociedadesExtranjeras
      ?.TotalSaldosFiscalesADiciembre31Parciales || 0) +
    (data?.Renglon52
      ?.TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosFiscalesADiciembre3152 ||
      0) +
    (data?.Renglon53?.Total53SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon54?.Total54SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon55?.TotalSaldosFiscalesADiciembre31Parciales || 0) +
    (data?.Renglon56?.Total56SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon57?.TotalOtrosIngresosSaldosFiscalesADiciembre31 || 0);
};

//Renglon 61 - Total Ingresos Netos
const calculateTotalIngresosNetos = (data: any) => {
  data.Renglon61.TotalIngresosNetosSaldosContablesADiciembre31 =
    (data?.Renglon58?.TotalIngresosBrutosSaldosContablesADiciembre31 || 0) -
    (data?.Renglon59
      ?.TotalMenosDevolucionesDescuentosRebajasSaldosContablesADiciembre31 ||
      0);

  data.Renglon61.TotalIngresosNetosSaldosFiscalesADiciembre31 =
    (data?.Renglon58?.TotalIngresosBrutosSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon59
      ?.TotalMenosDevolucionesDescuentosRebajasSaldosFiscalesADiciembre31 ||
      0) -
    (data?.Renglon60
      ?.TotalIngresosNoConstituidosDeRentaNiGananciaOcasionalSaldosFiscalesADiciembre31 ||
      0);
};

//Renglon 62 - Mas Costo De Fabricacion Del Periodo
const calculateTotalCostosFabricacion = (data: any) => {
  if (data?.["61CostosDeLasMercanciasFabricadasYVendidas"] == null) {
    return;
  }

  data[
    "61CostosDeLasMercanciasFabricadasYVendidas"
  ].AsistenciaTecnica.MasCostoDeFabricacionDelPeriodo.SaldosContablesADiciembre31Parciales =
    (data?.TotalCostosSaldosContablesADiciembre31 || 0) -
    (data?.["61CostosDeLasMercanciasFabricadasYVendidas"]?.AsistenciaTecnica
      ?.MenosInventarioFinalDeTrabajoEnProceso
      ?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.["61CostosDeLasMercanciasFabricadasYVendidas"]?.AsistenciaTecnica
      ?.MasInventarioInicialDeProductoTerminado
      ?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.["61CostosDeLasMercanciasFabricadasYVendidas"]?.AsistenciaTecnica
      ?.MenosInventarioFinalDeProductoTerminado
      ?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.["61CostosDeLasMercanciasFabricadasYVendidas"]
      ?.CostoDeVentasParaComerciasntesQueUtilizanJuegoDeInventarios
      ?.InventarioInicial?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.["61CostosDeLasMercanciasFabricadasYVendidas"]
      ?.CostoDeVentasParaComerciasntesQueUtilizanJuegoDeInventarios
      ?.MasComprasLocales?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.["61CostosDeLasMercanciasFabricadasYVendidas"]
      ?.CostoDeVentasParaComerciasntesQueUtilizanJuegoDeInventarios
      ?.MasImportaciones?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.["61CostosDeLasMercanciasFabricadasYVendidas"]
      ?.CostoDeVentasParaComerciasntesQueUtilizanJuegoDeInventarios
      ?.MenosInventarioFinal?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.["61CostosDeLasMercanciasFabricadasYVendidas"]
      ?.CostoDeVentasParaComerciantesQueUtilizanSistemaPermanente
      ?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.["6140CostoDeLasActividadesQueFormanLasRentasExentas"]
      ?.CostoDeLasActividadesQueFormanLasRentasExentas
      .SaldosContablesADiciembre31Parciales || 0) -
    (data?.["6140CostoDeLasActividadesQueFormanLasRentasExentas"]
      ?.CostoFiscalDeActivosFijosOBiologicosVendidosYPoseidosMenosDeDosAnios
      ?.SaldosContablesADiciembre31Parciales || 0);
};

//Renglon 63 - Referencias
const calculateReferences63 = (data: any) => {
  data.Renglon63[
    "5105BeneficiosAEmpleadosDeCortoPlayzo"
  ].AportesAEPS.SaldosContablesADiciembre31Parciales =
    data?.Renglon34?.["510569EPS"].SaldosContablesADiciembre31Parciales || 0;

  data.Renglon63[
    "5105BeneficiosAEmpleadosDeCortoPlayzo"
  ].AportesAARL.SaldosContablesADiciembre31Parciales =
    data?.Renglon34?.["510568ARL"].SaldosContablesADiciembre31Parciales || 0;

  data.Renglon63[
    "5105BeneficiosAEmpleadosDeCortoPlayzo"
  ].AportesAFondosDePensiones.SaldosContablesADiciembre31Parciales =
    data?.Renglon34?.["510570FondosPensiones"]
      .SaldosContablesADiciembre31Parciales || 0;

  data.Renglon63[
    "5105BeneficiosAEmpleadosDeCortoPlayzo"
  ].AportesAlSENA.SaldosContablesADiciembre31Parciales =
    data?.Renglon35?.["510578SENA"].SaldosContablesADiciembre31Parciales || 0;

  data.Renglon63[
    "5105BeneficiosAEmpleadosDeCortoPlayzo"
  ].AportesAlICBF.SaldosContablesADiciembre31Parciales =
    data?.Renglon35?.["510575ICBF"].SaldosContablesADiciembre31Parciales || 0;

  data.Renglon63[
    "5105BeneficiosAEmpleadosDeCortoPlayzo"
  ].AportesACajasDeCompensacion.SaldosContablesADiciembre31Parciales =
    data?.Renglon35?.["510572CajaComp"].SaldosContablesADiciembre31Parciales ||
    0;
};

//Renglon 64 - Referencias
const calculateReferences64 = (data: any) => {
  data.Renglon64[
    "5205BeneficiosALosEmpleadosCortoPlayzo"
  ].AportesAEPS.SaldosContablesADiciembre31Parciales =
    data?.Renglon34?.["520569EPS"].SaldosContablesADiciembre31Parciales || 0;

  data.Renglon64[
    "5205BeneficiosALosEmpleadosCortoPlayzo"
  ].AportesAARL.SaldosContablesADiciembre31Parciales =
    data?.Renglon34?.["520568ARL"].SaldosContablesADiciembre31Parciales || 0;

  data.Renglon64[
    "5205BeneficiosALosEmpleadosCortoPlayzo"
  ].AportesAFondosDePensiones.SaldosContablesADiciembre31Parciales =
    data?.Renglon34?.["520570FondosPensiones"]
      .SaldosContablesADiciembre31Parciales || 0;

  data.Renglon64[
    "5205BeneficiosALosEmpleadosCortoPlayzo"
  ].AportesAlSENA.SaldosContablesADiciembre31Parciales =
    data?.Renglon35?.["520578SENA"].SaldosContablesADiciembre31Parciales || 0;

  data.Renglon64[
    "5205BeneficiosALosEmpleadosCortoPlayzo"
  ].AportesAlICBF.SaldosContablesADiciembre31Parciales =
    data?.Renglon35?.["520575ICBF"].SaldosContablesADiciembre31Parciales || 0;

  data.Renglon64[
    "5205BeneficiosALosEmpleadosCortoPlayzo"
  ].AportesACajasDeCompensacion.SaldosContablesADiciembre31Parciales =
    data?.Renglon35?.["520572CajaComp"].SaldosContablesADiciembre31Parciales ||
    0;
};

//Renglon 67 - Total Costos y Gastos Deducibles
const calculateTotalCostosGastosDeducibles = (data: any) => {
  data.Renglon67.TotalCostosYGastosDeduciblesSaldosContablesADiciembre31 =
    (data?.Renglon62?.TotalCostosSaldosContablesADiciembre31 || 0) +
    (data?.Renglon63?.TotalGastosDeAdministracionSaldosContablesADiciembre31 ||
      0) +
    (data?.Renglon64
      ?.TotalGastosDeDistribucionYVentasSaldosContablesADiciembre31 || 0) +
    (data?.Renglon65?.TotalesSaldosContablesADiciembre31 || 0) +
    (data?.Renglon66?.TotalOtrosGastosYDeduccionesSaldosContablesADiciembre31 ||
      0);

  data.Renglon67.TotalCostosYGastosDeduciblesSaldosFiscalesADiciembre31 =
    (data?.Renglon62?.TotalCostosSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon63?.TotalGastosDeAdministracionSaldosFiscalesADiciembre31 ||
      0) +
    (data?.Renglon64
      ?.TotalGastosDeDistribucionYVentasSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon65?.TotalesSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon66?.TotalOtrosGastosYDeduccionesSaldosFiscalesADiciembre31 ||
      0);
};

//Renglon 72 - Total Renta Liquida Ordinaria del Ejercicio
const calculateRentaLiquidaOrdinariaSinCasillas = (data: any) => {
  const valueContable =
    (data?.Renglon61?.TotalIngresosNetosSaldosContablesADiciembre31 || 0) +
    (data?.Renglon69?.SaldosContablesADiciembre31Parciales || 0) +
    (data?.Renglon70
      ?.TotalRentaPorRecuperacionDeDeduccionesSaldosContablesADiciembre31 ||
      0) +
    (data?.Renglon71ValorIngresosBrutosQueCorresponden
      ?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.Renglon52
      ?.TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosContablesADiciembre3152 ||
      0) -
    (data?.Renglon53?.Total53SaldosContablesADiciembre31 || 0) -
    (data?.Renglon54?.Total54SaldosContablesADiciembre31 || 0) -
    (data?.Renglon55?.TotalSaldosContablesADiciembre31Parciales || 0) -
    (data?.Renglon56?.Total56SaldosContablesADiciembre31 || 0) -
    (data?.Renglon67?.TotalCostosYGastosDeduciblesSaldosContablesADiciembre31 ||
      0) -
    (data?.Renglon68?.SaldosContablesADiciembre31Parciales || 0);

  const valueFiscal =
    (data?.Renglon61?.TotalIngresosNetosSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon69?.SaldosFiscalesADiciembre31Parciales || 0) +
    (data?.Renglon70
      ?.TotalRentaPorRecuperacionDeDeduccionesSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon71ValorIngresosBrutosQueCorresponden
      ?.SaldosFiscalesADiciembre31Parciales || 0) -
    (data?.Renglon52
      ?.TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosFiscalesADiciembre3152 ||
      0) -
    (data?.Renglon53?.Total53SaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon54?.Total54SaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon55?.TotalSaldosFiscalesADiciembre31Parciales || 0) -
    (data?.Renglon56?.Total56SaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon67?.TotalCostosYGastosDeduciblesSaldosFiscalesADiciembre31 ||
      0) -
    (data?.Renglon68?.SaldosFiscalesADiciembre31Parciales || 0);

  data.Renglon72.TotalRentaLiquidaOrdinariaDelEjercicioSaldosContablesADiciembre31 =
    valueContable > 0 ? valueContable : 0;
  data.Renglon72.TotalRentaLiquidaOrdinariaDelEjercicioSaldosFiscalesADiciembre31 =
    valueFiscal > 0 ? valueFiscal : 0;
};

//Renglon 73 - Total Perdida Liquida del Ejercicio
const perdidaLiquidaSinCasillas = (data: any) => {
  const valueContable =
    (data?.Renglon52
      ?.TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosContablesADiciembre3152 ||
      0) +
    (data?.Renglon53?.Total53SaldosContablesADiciembre31 || 0) +
    (data?.Renglon54?.Total54SaldosContablesADiciembre31 || 0) +
    (data?.Renglon55?.TotalSaldosContablesADiciembre31Parciales || 0) +
    (data?.Renglon56?.Total56SaldosContablesADiciembre31 || 0) +
    (data?.Renglon67?.TotalCostosYGastosDeduciblesSaldosContablesADiciembre31 ||
      0) +
    (data?.Renglon68?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.Renglon61?.TotalIngresosNetosSaldosContablesADiciembre31 || 0) -
    (data?.Renglon69?.SaldosContablesADiciembre31Parciales || 0) -
    (data?.Renglon70
      ?.TotalRentaPorRecuperacionDeDeduccionesSaldosContablesADiciembre31 ||
      0) -
    (data?.Renglon71ValorIngresosBrutosQueCorresponden
      ?.SaldosContablesADiciembre31Parciales || 0);

  const valueFiscal =
    (data?.Renglon52
      ?.TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosFiscalesADiciembre3152 ||
      0) +
    (data?.Renglon53?.Total53SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon54?.Total54SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon55?.TotalSaldosFiscalesADiciembre31Parciales || 0) +
    (data?.Renglon56?.Total56SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon67?.TotalCostosYGastosDeduciblesSaldosFiscalesADiciembre31 ||
      0) +
    (data?.Renglon68?.SaldosFiscalesADiciembre31Parciales || 0) -
    (data?.Renglon61?.TotalIngresosNetosSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon69?.SaldosFiscalesADiciembre31Parciales || 0) -
    (data?.Renglon70
      ?.TotalRentaPorRecuperacionDeDeduccionesSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon71ValorIngresosBrutosQueCorresponden
      ?.SaldosFiscalesADiciembre31Parciales || 0);

  data.Renglon73.TotalPerdidaLiquidaDelEjercicioSaldosContablesADiciembre31 =
    valueContable > 0 ? valueContable : 0;
  data.Renglon73.TotalPerdidaLiquidaDelEjercicioSaldosFiscalesADiciembre31 =
    valueFiscal > 0 ? valueFiscal : 0;
};

//Renglon 74 - Total Compensaciones
const calculateTotalCompensaciones = (data: any) => {
  const valueFiscal =
    (data?.Renglon74?.CompenPerFisc?.SaldosFiscalesADiciembre31Parciales || 0) +
    (data?.Renglon74?.CompensacionesDeExcesosDeRentaPresuntiva?.SubRentPres
      ?.SaldosFiscalesADiciembre31Parciales || 0);

  data.Renglon74.CompensacionesDeExcesosDeRentaPresuntiva.ValFinRentPres.SaldosFiscalesADiciembre31Parciales =
    valueFiscal >
    (data?.Renglon72
      ?.TotalRentaLiquidaOrdinariaDelEjercicioSaldosFiscalesADiciembre31 || 0)
      ? data?.Renglon72
          ?.TotalRentaLiquidaOrdinariaDelEjercicioSaldosFiscalesADiciembre31 ||
        0
      : valueFiscal;

  data.Renglon74.TotalCompensacionesSaldosFiscalesADiciembre31 =
    data?.Renglon74?.CompensacionesDeExcesosDeRentaPresuntiva?.ValFinRentPres
      ?.SaldosFiscalesADiciembre31Parciales || 0;
};

//Renglon 75 - Renta Liquida Sin Casillas 52 a 56
const calculateRentaLiquidaSinCasillas75 = (data: any) => {
  const valueFiscal =
    (data?.Renglon72
      ?.TotalRentaLiquidaOrdinariaDelEjercicioSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon74?.TotalCompensacionesSaldosFiscalesADiciembre31 || 0);

  data.Renglon75.TotalRentaLiquidaSaldosFiscalesADiciembre31 =
    valueFiscal > 0 ? valueFiscal : 0;
};

//Renglon 79 - Total Renta Liquida Gravada Saldos Fiscales a Diciembre 31
const calculateRentaLiquidaGravadaSinCasillas = (data: any) => {
  const condition =
    (data?.Renglon76?.SaldosFiscalesADiciembre31Parciales || 0) >
    (data?.Renglon76?.SaldosFiscalesADiciembre31Parciales || 0);

  data.Renglon79.TotalesSaldosFiscalesADiciembre31 = condition
    ? (data?.Renglon76?.SaldosFiscalesADiciembre31Parciales || 0) -
      (data?.Renglon77?.TotalRentasExentasSaldosFiscalesADiciembre31 || 0) +
      (data?.Renglon78?.TotalRentasGravablesSaldosFiscalesADiciembre31 || 0)
    : (data?.Renglon76?.SaldosFiscalesADiciembre31Parciales || 0) -
      (data?.Renglon77?.TotalRentasExentasSaldosFiscalesADiciembre31 || 0) +
      (data?.Renglon78?.TotalRentasGravablesSaldosFiscalesADiciembre31 || 0);
};

//Renglon 85 - Total Renta Liquida por Escalones Saldos Fiscales a Diciembre 31
const calculateRenglon85 = (data: any) => {
  const valueFiscalEsc1 =
    (data?.Renglon80?.TotalesSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon83
      ?.TotalCostosYDeduccionesPorGananciasOcasionalesSaldosFiscalesADiciembre31 ||
      0) -
    (data?.Renglon84
      ?.TotalGananciasOcasionalesNoGravadasYExentasSaldosFiscalesADiciembre31 ||
      0);

  const valueFiscalEsc2 =
    (data?.Renglon80?.TotalesSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon81?.TotalRentaDeudoresSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon83
      ?.TotalCostosYDeduccionesPorGananciasOcasionalesSaldosFiscalesADiciembre31 ||
      0) -
    (data?.Renglon84
      ?.TotalGananciasOcasionalesNoGravadasYExentasSaldosFiscalesADiciembre31 ||
      0);

  const valueFiscalEsc3P1 =
    (data?.Renglon81?.TotalRentaDeudoresSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon82
      ?.TotalUtilizacionPerdidasFiscalesAcumuladasSaldosFiscalesADiciembre31 ||
      0);

  const valueFiscalEsc3P2 = valueFiscalEsc1 + valueFiscalEsc3P1;

  const valueFiscalEsc4 =
    (data?.Renglon80?.TotalesSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon81?.TotalRentaDeudoresSaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon83
      ?.TotalCostosYDeduccionesPorGananciasOcasionalesSaldosFiscalesADiciembre31 ||
      0);

  data.Renglon85.Esc1.SaldosFiscalesADiciembre31Parciales =
    (data?.Renglon81?.TotalRentaDeudoresSaldosFiscalesADiciembre31 || 0) === 0
      ? valueFiscalEsc1 > 0
        ? valueFiscalEsc1
        : 0
      : 0;

  data.Renglon85.Esc2.SaldosFiscalesADiciembre31Parciales =
    (data?.Renglon81?.TotalRentaDeudoresSaldosFiscalesADiciembre31 || 0) > 0
      ? (data?.Renglon82
          ?.TotalUtilizacionPerdidasFiscalesAcumuladasSaldosFiscalesADiciembre31 ||
          0) === 0
        ? valueFiscalEsc2 > 0
          ? valueFiscalEsc2
          : 0
        : 0
      : 0;

  data.Renglon85.Esc3.SaldosFiscalesADiciembre31Parciales =
    valueFiscalEsc1 > 0 ? (valueFiscalEsc3P1 > 0 ? valueFiscalEsc3P2 : 0) : 0;

  data.Renglon85.Esc4.SaldosFiscalesADiciembre31Parciales =
    (data?.Renglon80?.TotalesSaldosFiscalesADiciembre31 || 0) -
      (data?.Renglon83
        ?.TotalCostosYDeduccionesPorGananciasOcasionalesSaldosFiscalesADiciembre31 ||
        0) <
    0
      ? (data?.Renglon82
          ?.TotalUtilizacionPerdidasFiscalesAcumuladasSaldosFiscalesADiciembre31 ||
          0) === 0
        ? valueFiscalEsc4 > 0
          ? valueFiscalEsc4
          : 0
        : 0
      : 0;
};

//Renglon 86 - Total Impuesto Sobre la Renta Liquida Saldos Fiscales a Diciembre 31
const calculateRenglon86 = (data: any) => {
  data.Renglon86.TotalImpuestoSobreLaRentaLiquidaSaldosFiscalesADiciembre31 =
    Math.round(
      (data?.Renglon79?.TotalesSaldosFiscalesADiciembre31 || 0) * 0.35 * 1000
    ) / 1000;
};

//Renglon 87 - Dividendos o Participaciones
const calculateRenglon87 = (data: any) => {
  data.Renglon87.TotalDeDividendosYParticipacionesGravadasALaTarifaSaldosFiscalesADiciembre31 =
    Math.round(
      (data?.Renglon54?.Total54SaldosFiscalesADiciembre31 || 0) * 0.1 * 1000
    ) / 1000;
};

//Reglon 89 - Total Dividendos o Participaciones
const calculateRenglon89 = (data: any) => {
  data.Renglon89.Total89SaldosFiscalesADiciembre31 =
    Math.round(
      (data?.Renglon56?.Total56SaldosFiscalesADiciembre31 || 0) * 0.27 * 1000
    ) / 1000;
};

//Renglon 90 - Total Dividendos o Participaciones
const calculateRenglon90 = (data: any) => {
  data.Renglon90.Total90SaldosFiscalesADiciembre31 =
    Math.round(
      ((data?.Renglon57?.TotalOtrosIngresosSaldosFiscalesADiciembre31 || 0) *
        0.31 +
        (data?.Renglon53?.Total53SaldosFiscalesADiciembre31 || 0) * 0.69) *
        0.1 *
        1000
    ) / 1000;
};

//Renglon 91 - Total Dividendos o Participaciones
const calculateRenglon91 = (data: any) => {
  data.Renglon91.Total91SaldosFiscalesADiciembre31 =
    Math.round(
      (data?.Renglon52?.TotalDividendosYParticipacionesGravadasPorPersonasNaturalesSaldosFiscalesADiciembre3152 || 0) * 0.33 * 1000
    ) / 1000;
};

//Renglon 92 - Total Impuesto Sobre la Rentas Liquidas Gravables
const calculateRenglon92 = (data: any) => {
  data.Renglon92.TotalImpuestoSobreLaRentaLiquidaGravableSaldosFiscalesADiciembre31 = (data?.Renglon86?.TotalImpuestoSobreLaRentaLiquidaSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon87?.TotalDeDividendosYParticipacionesGravadasALaTarifaSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon88?.Total88SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon89?.Total89SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon90?.Total90SaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon91?.Total91SaldosFiscalesADiciembre31 || 0);
};

//Renglon 93 - Todo
const calculateRenglon93 = (data: any) => {
  data.Renglon93.DescuentosDonacionesEntidades.ValorQueInicialmenteSePodriaTomarComoDescuento.SaldosFiscalesADiciembre31Parciales =
    (data?.Renglon93?.DescuentosDonacionesEntidades?.DonacionHechaAFundacionPor?.SaldosFiscalesADiciembre31Parciales || 0) *
    (data?.Renglon93?.DescuentosDonacionesEntidades?.PorcentajeAplicable?.SaldosFiscalesADiciembre31Parciales || 0);

  data.Renglon93.DescuentosDonacionesEntidades.LimiteAlCualSeDebeSometerEsteDescuento.SaldosFiscalesADiciembre31Parciales = Math.round((data?.Renglon92?.Total92SaldosFiscalesADiciembre31 || 0) * 0.25 * 1000) / 1000;

  data.Renglon93.DescuentosDonacionesEntidades.ValorFinalQuePuedeTomarsePorEsteDescuento.SaldosFiscalesADiciembre31Parciales = (data?.Renglon93?.DescuentosDonacionesEntidades.ValorQueInicialmenteSePodriaTomarComoDescuento?.SaldosFiscalesADiciembre31Parciales || 0) >
    (data?.Renglon93?.DescuentosDonacionesEntidades.LimiteAlCualSeDebeSometerEsteDescuento?.SaldosFiscalesADiciembre31Parciales || 0)
    ? (data?.Renglon93?.DescuentosDonacionesEntidades.LimiteAlCualSeDebeSometerEsteDescuento?.SaldosFiscalesADiciembre31Parciales || 0)
    : (data?.Renglon93?.DescuentosDonacionesEntidades.ValorQueInicialmenteSePodriaTomarComoDescuento?.SaldosFiscalesADiciembre31Parciales || 0);

    const valueFiscal = (data?.Renglon93?.DescuentosDonacionesEntidades?.ValorFinalQuePuedeTomarsePorEsteDescuento?.SaldosFiscalesADiciembre31Parciales || 0) + ((data?.Renglon93?.DescuentosOtros?.PorIndustriaYComercioYAvisosYTablerosPagadosDuranteElAño?.SaldosFiscalesADiciembre31Parciales || 0) + (data?.Renglon93?.DescuentosOtros?.PorIVACompra?.SaldosFiscalesADiciembre31Parciales || 0) + (data?.Renglon93?.DescuentosOtros?.RetTrasladable?.SaldosFiscalesADiciembre31Parciales || 0) + (data?.Renglon93?.DescuentosOtros?.OtrosDescApliq?.SaldosFiscalesADiciembre31Parciales || 0));

  data.Renglon93.TotalDescuentosTributariosSaldosFiscalesADiciembre31 = valueFiscal > (data?.Renglon92?.Total92SaldosFiscalesADiciembre31 || 0) ? (data?.Renglon92?.Total92SaldosFiscalesADiciembre31 || 0) : valueFiscal;
};

//Renglon 94 impuesto neto renta
const calculateRenglon94 = (data: any) => {

  const valueFiscal =
    (data?.Renglon92?.Total92SaldosFiscalesADiciembre31 || 0) -
    (data?.Renglon93?.TotalDescuentosTributariosSaldosFiscalesADiciembre31 || 0);

  data.Renglon94.TotalImpuestoNetoRentaSaldosFiscalesADiciembre31 = valueFiscal > 0 ? valueFiscal : 0;
};

//Renglon 97 - Total Impuesto de Renta a Cargo
const calculateRenglon97 = (data: any) => {
  data.Renglon97.TotalSaldosFiscalesADiciembre31 =
    (data?.Renglon94?.TotalImpuestoNetoRentaSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon95ImpuestoDeGananciasOcasionales?.TotalImpuestoDeGananciasOcasionalesSaldosFiscalesADiciembre31 || 0) +
    (data?.Renglon96?.SaldosFiscalesADiciembre31Parciales || 0);
};

//Reglon 104 - todo
const calculateRenglon104 = (data: any) => {
  
  const calculateValor = (section: any, labelContable: string, labelFiscla: string) => {
    let valueContable = 0;
    let valueFiscal = 0;

    section?.InformacionPorEmpresa?.forEach((empresa: any) => {
      valueContable += empresa?.SaldosContablesADiciembre31 || 0;
      valueFiscal += empresa?.SaldosFiscalesADiciembre31 || 0;
    });
    
    section[labelContable] = valueContable;
    section[labelFiscla] = valueFiscal;
  };

  calculateValor(data?.Renglon104?.PorVentas, "TotalPorVentasSaldosContablesADiciembre31", "TotalPorVentasSaldosFiscalesADiciembre31");
  calculateValor(data?.Renglon104?.PorServicios, "TotalPorServiciosSaldosContablesADiciembre31", "TotalPorServiciosSaldosFiscalesADiciembre31");
  calculateValor(data?.Renglon104?.PorHonorariosYComisiones, "TotalPorHonorariosYComisionesSaldosContablesADiciembre31", "TotalPorHonorariosYComisionesSaldosFiscalesADiciembre31");
  calculateValor(data?.Renglon104?.PorRendimientoFinanciero, "TotalPorRendimientoFinancieroSaldosContablesADiciembre31", "TotalPorRendimientoFinancieroSaldosFiscalesADiciembre31");
  calculateValor(data?.Renglon104?.PorDividendosYParticipaciones, "TotalPorDividendosYParticipacionesSaldosContablesADiciembre31", "TotalPorDividendosYParticipacionesSaldosFiscalesADiciembre31");
  calculateValor(data?.Renglon104?.PorOtrosConceptosInteresesLoteriasYRifas, "TotalPorOtrosConceptosInteresesLoteriasYRifasSaldosContablesADiciembre31", "TotalPorOtrosConceptosInteresesLoteriasYRifasSaldosFiscalesADiciembre31");

  data.Renglon104.TotalOtrasRetencionesSaldosContablesADiciembre31 = (data?.Renglon104?.PorVentas?.TotalPorVentasSaldosContablesADiciembre31 || 0) + (data?.Renglon104?.PorServicios?.TotalPorServiciosSaldosContablesADiciembre31 || 0) + (data?.Renglon104?.PorHonorariosYComisiones?.TotalPorHonorariosYComisionesSaldosContablesADiciembre31 || 0) + (data?.Renglon104?.PorRendimientoFinanciero?.TotalPorRendimientoFinancieroSaldosContablesADiciembre31 || 0) + (data?.Renglon104?.PorDividendosYParticipaciones?.TotalPorDividendosYParticipacionesSaldosContablesADiciembre31 || 0) + (data?.Renglon104?.PorOtrosConceptosInteresesLoteriasYRifas?.TotalPorOtrosConceptosInteresesLoteriasYRifasSaldosContablesADiciembre31 || 0);

  data.Renglon104.TotalOtrasRetencionesSaldosFiscalesADiciembre31 = (data?.Renglon104?.PorVentas?.TotalPorVentasSaldosFiscalesADiciembre31 || 0) + (data?.Renglon104?.PorServicios?.TotalPorServiciosSaldosFiscalesADiciembre31 || 0) + (data?.Renglon104?.PorHonorariosYComisiones?.TotalPorHonorariosYComisionesSaldosFiscalesADiciembre31 || 0) + (data?.Renglon104?.PorRendimientoFinanciero?.TotalPorRendimientoFinancieroSaldosFiscalesADiciembre31 || 0) + (data?.Renglon104?.PorDividendosYParticipaciones?.TotalPorDividendosYParticipacionesSaldosFiscalesADiciembre31 || 0) + (data?.Renglon104?.PorOtrosConceptosInteresesLoteriasYRifas?.TotalPorOtrosConceptosInteresesLoteriasYRifasSaldosFiscalesADiciembre31 || 0);

};

//Renglon 105 - Total Retenciones
const calculateRenglon105 = (data: any) => {
  data.Renglon105.TotalSaldosFiscalesADiciembre31 = (data?.Renglon103Autocorretenciones?.TotalesSaldosFiscalesADiciembre31 || 0) + (data?.Renglon104?.TotalOtrasRetencionesSaldosFiscalesADiciembre31 || 0);
}

//Renglon 110 - Saldo a pagar por impuesto
const calculateRenglon110 = (data: any) => {
  const valueFiscal = (data?.Renglon97?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon106?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon108?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon109?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon98?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon99?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon100?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon101MenosAnticipoRentaLiquidadiGravableAnterior?.TotalesSaldosFiscalesADiciembre31 || 0) - (data?.Renglon102MenosSaldoAFavorRentaSinSolicitudDeDevolucionNiCompensacion?.TotalesSaldosFiscalesADiciembre31 || 0) - (data?.Renglon105?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon107?.TotalSaldosFiscalesADiciembre31 || 0);

  data.Renglon110.TotalSaldosFiscalesADiciembre31 = valueFiscal > 0 ? valueFiscal : 0;
};

// Renglon 111 - Sanciones
const calculateRenglon111 = (data: any) => {
  data.Renglon111Sanciones.TotalesSaldosFiscalesADiciembre31 = data?.Renglon111Sanciones?.PorExtemporaneidad || 0;
}

//Renglon 112 - Total Saldo a pagar
const calculateRenglon112 = (data: any) => {
  const valueFiscal = (data?.Renglon97?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon106?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon108?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon109?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon111Sanciones?.TotalesSaldosFiscalesADiciembre31 || 0) - (data?.Renglon98?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon99?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon100?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon101MenosAnticipoRentaLiquidadiGravableAnterior?.TotalesSaldosFiscalesADiciembre31 || 0) - (data?.Renglon102MenosSaldoAFavorRentaSinSolicitudDeDevolucionNiCompensacion?.TotalesSaldosFiscalesADiciembre31 || 0) - (data?.Renglon105?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon107?.TotalSaldosFiscalesADiciembre31 || 0);

  data.Renglon112.TotalSaldosFiscalesADiciembre31 = valueFiscal > 0 ? valueFiscal : 0;
};

//Renglon 113 - Total Saldos Fiscales a Diciembre 31
const calculateRenglon113 = (data: any) => {
  const valueFiscal = (data?.Renglon98?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon99?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon100?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon101MenosAnticipoRentaLiquidadiGravableAnterior?.TotalesSaldosFiscalesADiciembre31 || 0) + (data?.Renglon102MenosSaldoAFavorRentaSinSolicitudDeDevolucionNiCompensacion?.TotalesSaldosFiscalesADiciembre31 || 0) + (data?.Renglon105?.TotalSaldosFiscalesADiciembre31 || 0) + (data?.Renglon107?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon97?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon106?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon108?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon109?.TotalSaldosFiscalesADiciembre31 || 0) - (data?.Renglon111Sanciones?.TotalesSaldosFiscalesADiciembre31 || 0);

  data.Renglon113.TotalSaldosFiscalesADiciembre31 = valueFiscal > 0 ? valueFiscal : 0;
}

// FUNCIÓN PRINCIPAL PARA CALCULAR TODOS LOS DATOS NO TOTALES
export const calculateNonTotalData = (data: any) => {
  if (!data) {
    return;
  }

  calculateImpuestoPorPagarDeRentaYComplementarios(data);
  calculateTotalCostosFabricacion(data);
  calculateReferences63(data);
  calculateReferences64(data);
  calculateTotalPasivos(data);
  calculateRentaLiquidaOrdinariaSinCasillas(data);
  perdidaLiquidaSinCasillas(data);
  calculateTotalCompensaciones(data);
  calculateRentaLiquidaSinCasillas75(data);
  calculateRentaLiquidaGravadaSinCasillas(data);
  calculateRenglon85(data);
  calculateRenglon86(data);
  calculateRenglon87(data);
  calculateRenglon89(data);
  calculateRenglon90(data);
  calculateRenglon91(data);
  calculateRenglon92(data);
  calculateRenglon93(data);
  calculateRenglon94(data);
  calculateRenglon97(data);
  calculateRenglon104(data);
  calculateRenglon105(data);
  calculateRenglon110(data);
  calculateRenglon111(data);
  calculateRenglon112(data);
  calculateRenglon113(data);
};

// FUNCIÓN PRINCIPAL PARA CALCULAR TODOS LOS TOTALES
export const calculateTotalData = (data: any) => {
  if (!data) {
    return;
  }

  calculateTotalSaldos(data.Renglon45, "Renglon45");

  // Luego calculamos totales que dependen de los anteriores
  calculateTotalPatrimonioBruto(data);  // Depende de Renglones 36-43
  calculateTotalPatrimonioLiquidoPositivo(data);  // Depende de Renglon44 y 45

  calculateTotalPasivos(data.Renglon46);  

  calculateTotalIngresosBrutos(data);  // Depende de Renglones 47-57
  calculateTotalIngresosNetos(data);  // Depende de Renglon58, 59, 60
  calculateTotalCostosGastosDeducibles(data);  // Depende de Renglones 62-66
};

